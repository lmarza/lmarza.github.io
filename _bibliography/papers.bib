---
---

@article{marzari2025advancing,
      title={Advancing Neural Network Verification through Hierarchical Safety Abstract Interpretation}, 
      author={Luca Marzari and Isabella Mastroeni and Alessandro Farinelli},
      abstract={Traditional methods for formal verification (FV) of deep neural networks (DNNs) are constrained by a binary encoding of safety properties, where a model is classified as either safe or unsafe (robust or not robust). This binary encoding fails to capture the nuanced safety levels within a model, often resulting in either overly restrictive or too permissive requirements. In this paper, we introduce a novel problem formulation called Abstract DNN-Verification, which verifies a hierarchical structure of unsafe outputs, providing a more granular analysis of the safety aspect for a given DNN. Crucially, by leveraging abstract interpretation and reasoning about output reachable sets, our approach enables assessing multiple safety levels during the FV process, requiring the same (in the worst case) or even potentially less computational effort than the traditional binary verification approach. Specifically, we demonstrate how this formulation allows rank adversarial inputs according to their abstract safety level violation, offering a more detailed evaluation of the model's safety and robustness. Our contributions include a theoretical exploration of the relationship between our novel abstract safety formulation and existing approaches that employ abstract interpretation for robustness verification, complexity analysis of the novel problem introduced, and an empirical evaluation considering both a complex deep reinforcement learning task (based on Habitat 3.0) and standard DNN-Verification benchmarks.},
      year={2025},
      journal={Proceedings of the 28th European Conference on Artificial Intelligence (ECAI)},
      abbr={ECAI},
      selected={false},
      pdf={https://arxiv.org/pdf/2505.05235},
      html={https://arxiv.org/abs/2505.05235},
      url={https://arxiv.org/abs/2505.05235}, 
}


@article{marzari2025designingcontrolbarrierfunction,
      title={Designing Control Barrier Function via Probabilistic Enumeration for Safe Reinforcement Learning Navigation}, 
      author={Luca Marzari and Francesco Trotti and Enrico Marchesini and Alessandro Farinelli},
      abstract={Achieving safe autonomous navigation systems is critical for deploying robots in dynamic and uncertain real-world environments. In this paper, we propose a hierarchical control framework leveraging neural network verification techniques to design control barrier functions (CBFs) and policy correction mechanisms that ensure safe reinforcement learning navigation policies. Our approach relies on probabilistic enumeration to identify unsafe regions of operation, which are then used to construct a safe CBF-based control layer applicable to arbitrary policies. We validate our framework both in simulation and on a real robot, using a standard mobile robot benchmark and a highly dynamic aquatic environmental monitoring task. These experiments demonstrate the ability of the proposed solution to correct unsafe actions while preserving efficient navigation behavior. Our results show the promise of developing hierarchical verification-based systems to enable safe and robust navigation behaviors in complex scenarios.},
      year={2025},
      abbr={ArXiv},
      selected={false},
      journal={arXiv preprint arXiv:2504.21643},
      pdf={https://arxiv.org/pdf/2504.21643},
      html={https://arxiv.org/abs/2504.21643},
      url={https://arxiv.org/abs/2504.21643}, 
}

@article{marzari2023airo,
  title={Scaling \#DNN-Verification Tools with Efficient Bound Propagation and Parallel Computing},
  author={Marzari, Luca and Roncolato, Gabriele and Farinelli, Alessandro},
  journal={},
  organization={AIxIA},
  abbr={AIRO},
  abstract={Deep Neural Networks (DNNs) are powerful tools that have shown extraordinary results in many scenarios, ranging from pattern recognition to complex robotic problems. However, their intricate designs and lack of transparency raise safety concerns when applied in real-world applications. In this context, Formal Verification (FV) of DNNs has emerged as a valuable solution to provide provable guarantees on the safety aspect. Nonetheless, the binary answer (i.e., safe or unsafe) could be not informative enough for direct safety interventions such as safety model ranking or selection. To address this limitation, the FV problem has recently been extended to the counting version, called #DNN-Verification, for the computation of the size of the unsafe regions in a given safety property's domain. Still, due to the complexity of the problem, existing solutions struggle to scale on real-world robotic scenarios, where the DNN can be large and complex. To address this limitation, inspired by advances in FV, in this work, we propose a novel strategy based on reachability analysis combined with Symbolic Linear Relaxation and parallel computing to enhance the efficiency of existing exact and approximate FV for DNN counters. The empirical evaluation on standard FV benchmarks and realistic robotic scenarios shows a remarkable improvement in scalability and efficiency, enabling the use of such techniques even for complex robotic applications.},
  selected={false},
  pdf={https://arxiv.org/pdf/2312.05890.pdf},
  html={https://arxiv.org/abs/2312.05890},
  year={2023}
}

@article{marzari2024modelverification,
  title={ModelVerification.jl: a Comprehensive Toolbox for Formally Verifying Deep Neural Networks},
  author={Wei, Tianhao and Marzari*, Luca and Yun*, Kai S and Hu*, Hanjiang and Niu*, Peizhi and Luo, Xusheng and Liu, Changliu},
  abbr={CAV},
  abstract={Deep Neural Networks (DNN) are crucial in approximating nonlinear functions across diverse applications, ranging from image classification to control. Verifying specific input-output properties can be a highly challenging task due to the lack of a single, self-contained framework that allows a complete range of verification types. To this end, we present ModelVerification.jl (MV), the first comprehensive, cutting-edge toolbox that contains a suite of state-of-the-art methods for verifying different types of DNNs and safety specifications. This versatile toolbox is designed to empower developers and machine learning practitioners with robust tools for verifying and ensuring the trustworthiness of their DNN models.},
  selected={False},
  journal={37th International Conference on Computer Aided Verification (CAV)},
  pdf={https://arxiv.org/pdf/2407.01639},
  code={https://github.com/intelligent-control-lab/ModelVerification.jl},
  html={https://arxiv.org/abs/2407.01639},
  year={2025}
  }

  @article{jiang2025robustx,
  title={RobustX: Robust Counterfactual Explanations Made Easy},
  author={Jiang*, Junqi and Marzari*, Luca and Purohit, Aaryan and Leofante, Francesco},
  journal={International Joint Conference on Artificial Intelligence (IJCAI)},
  abstract={The increasing use of Machine Learning (ML) models to aid decision-making in high-stakes industries demands explainability to facilitate trust. Counterfactual Explanations (CEs) are ideally suited for this, as they can offer insights into the predictions of an ML model by illustrating how changes in its input data may lead to different outcomes. 
   However, for CEs to realise their explanatory potential, significant challenges remain in ensuring their robustness under slight changes in the scenario being explained. Despite the widespread recognition of CEs' robustness as a fundamental requirement, a lack of standardised tools and benchmarks hinders a comprehensive and effective comparison of robust CE generation methods. In this paper, we introduce RobustX, an open-source Python library implementing a collection of CE generation and evaluation methods, with a focus on the robustness property. RobustX provides interfaces to several existing methods from the literature, enabling streamlined access to state-of-the-art techniques. The library is also easily extensible, allowing fast prototyping of novel robust CE generation and evaluation methods.},
  abbr={IJCAI},
  selected={False},
  pdf={https://arxiv.org/pdf/2502.13751},
  code={https://github.com/RobustCounterfactualX/RobustX},
  html={https://arxiv.org/pdf/2502.13751},
  year={2025}
}

@article{marzari2025Probabilistic,
  title={Probabilistically Robust Counterfactual Explanations under Model Changes},
  author={Marzari, Luca and Leofante, Francesco and Cicalese, Ferdinando and Farinelli, Alessandro},
  abbr={ArXiv},
  abstract={ We study the problem of generating robust counterfactual explanations for deep learning models subject to model changes. We focus on plausible model changes altering model parameters and propose a novel framework to reason about the robustness property in this setting. To motivate our solution, we begin by showing for the first time that computing the robustness of counterfactuals with respect to model changes is NP-hard. As this (practically) rules out the existence of scalable algorithms for exactly computing robustness, we propose a novel probabilistic approach which is able to provide tight estimates of robustness with strong guarantees while preserving scalability. Remarkably, and differently from existing solutions targeting plausible model changes, our approach does not impose requirements on the network to be analysed, thus enabling robustness analysis on a wider range of architectures, including state-of-the-art tabular transformers. A thorough experimental analysis on four binary classification datasets reveals that our method improves the state of the art in generating robust explanations, outperforming existing methods.},
  selected={false},
  journal={Preprint},
  pdf={prob_guarantees-journal.pdf},
  code={https://github.com/lmarza/APAS},
  html={https://www.researchgate.net/publication/389435880_Probabilistically_Robust_Counterfactual_Explanations_under_Model_Changes},
  year={2025}
}

@article{marzari2024improving,
  title={Improving Policy Optimization via ε-Retrain},
  author={Marzari, Luca and Donti, Priya L and Liu, Changliu and Marchesini, Enrico},
  abbr={AAMAS},
  abstract={We present ε-retrain, an exploration strategy designed to encourage a behavioral preference while optimizing policies with monotonic improvement guarantees. To this end, we introduce an iterative procedure for collecting retrain areas -- parts of the state space where an agent did not follow the behavioral preference. Our method then switches between the typical uniform restart state distribution and the retrain areas using a decaying factor ε, allowing agents to retrain on situations where they violated the preference. Experiments over hundreds of seeds across locomotion, navigation, and power network tasks show that our method yields agents that exhibit significant performance and sample efficiency improvements. Moreover, we employ formal verification of neural networks to provably quantify the degree to which agents adhere to behavioral preferences.},
  selected={False},
  journal={Proceedings of the International Conference on Autonomous Agents and MultiAgent Systems (AAMAS)},
  booktitle={Proceedings of the International Conference on Autonomous Agents and MultiAgent Systems (AAMAS)}, 
  pdf={https://arxiv.org/pdf/2406.08315},
  html={https://arxiv.org/abs/2406.08315},
  year={2025}
  }


@article{marzari2024Rigorous,
  title={Rigorous Probabilistic Guarantees for Robust Counterfactual Explanations},
  author={Marzari, Luca and Leofante, Francesco and Cicalese, Ferdinando and Farinelli, Alessandro},
  journal={Proceedings of the 27th European Conference on Artificial Intelligence (ECAI)},
  abbr={ECAI},
  abstract={We study the problem of assessing the robustness of counterfactual explanations for deep learning models. We focus on plausible model shifts altering model parameters and propose a novel framework to reason about the robustness property in this setting. To motivate our solution, we begin by showing for the first time that computing the robustness of counterfactuals with respect to plausible model shifts is NP-complete. As this (practically) rules out the existence of scalable algorithms for exactly computing robustness, we propose a novel probabilistic approach which is able to provide tight estimates of robustness with strong guarantees while preserving scalability. Remarkably, and differently from existing solutions targeting plausible model shifts, our approach does not impose requirements on the network to be analyzed, thus enabling robustness analysis on a wider range of architectures. Experiments on four binary classification datasets indicate that our method improves the state of the art in generating robust explanations, outperforming existing methods on a range of metrics.},
  selected={true},
  pdf={https://arxiv.org/pdf/2407.07482},
  code={https://github.com/lmarza/APAS},
  html={https://arxiv.org/abs/2407.07482},
  year={2024}
}

@article{marzari2023enumeration,
  title={Enumerating Safe Regions in Deep Neural Networks with Provable Probabilistic Guarantees},
  author={Marzari, Luca and Corsi, Davide and Marchesini, Enrico and Farinelli, Alessandro and Cicalese, Ferdinando},
  journal={Proceedings of the AAAI Conference on Artificial Intelligence (AAAI)},
  abbr={AAAI},
  abstract={Identifying safe areas is a key point to guarantee trust for systems that are based on Deep Neural Networks (DNNs). To this end, we introduce the AllDNN-Verification problem: given a safety property and a DNN, enumerate the set of all the regions of the property input domain which are safe, i.e., where the property does hold. Due to the #P-hardness of the problem, we propose an efficient approximation method called ε-ProVe. Our approach exploits a controllable underestimation of the output reachable sets obtained via statistical prediction of tolerance limits, and can provide a tight (with provable probabilistic guarantees) lower estimate of the safe areas. Our empirical evaluation on different standard benchmarks shows the scalability and effectiveness of our method, offering valuable insights for this new type of verification of DNNs.},
  selected={true},
  pdf={https://arxiv.org/pdf/2308.09842.pdf},
  html={https://arxiv.org/abs/2308.09842},
  year={2024}
}


@article{marzari2023dnn,
  title={Formal Verification for Counting Unsafe Inputs in Deep Neural Networks},
  author={Marzari*, Luca and Corsi*, Davide and Cicalese, Ferdinando and Farinelli, Alessandro},
  journal={2nd Workshop on Formal Verification of Machine Learning  (ICML)},
  organization={ICML},
  abbr={WFVML ICML},
  abstract={Traditionally, Formal Verification (FV) of Deep Neural Networks (DNN) can be employed to check whether a DNN is unsafe w.r.t. some given property (i.e., whether there is at least one un- safe input configuration). However, the binary answer typically returned could be not informa- tive enough for other purposes, such as shielding, model selection, or training improvements. In this paper, we summarize the contribution of our work (Marzari et al., 2023) focused on the #DNN-Verification problem, which involves counting the number of input configurations of a DNN that result in a violation of a particular safety property. We analyze the complexity of this problem and show a novel approach that returns the exact count of violations. Due to the #P-completeness of the problem, we also propose a randomized, approximate method that provides a provable probabilistic bound of the correct count while significantly reducing compu- tational requirements tested on a set of safety- critical benchmarks.},
  selected={false},
  pdf={https://files.sri.inf.ethz.ch/wfvml23/papers/paper_4.pdf},
  html={https://www.ml-verification.com/accepted-papers},
  year={2023}
}

@article{marzari2023dnn,
  title={The \#DNN-Verification Problem: Counting Unsafe Inputs for Deep Neural Networks},
  author={Marzari*, Luca and Corsi*, Davide and Cicalese, Ferdinando and Farinelli, Alessandro},
  journal={Internation Joint Conference on Artificial Intelligence (IJCAI)},
  organization={IJCAI},
  abbr={IJCAI},
  abstract={Deep Neural Networks are increasingly adopted in critical tasks that require a high level of safety, e.g., autonomous driving. While state-of-the-art verifiers can be employed to check whether a DNN is unsafe w.r.t. some given property (i.e., whether there is at least one unsafe input configuration), their yes/no output is not informative enough for other purposes, such as shielding, model selection, or training improvements. In this paper, we introduce the #DNN-Verification problem, which involves counting the number of input configurations of a DNN that result in a violation of a particular safety property. We analyze the complexity of this problem and propose a novel approach that returns the exact count of violations. Due to the #P-completeness of the problem, we also propose a randomized, approximate method that provides a provable probabilistic bound of the correct count while significantly reducing computational requirements. We present experimental results on a set of safety-critical benchmarks that demonstrate the effectiveness of our approximate method and evaluate the tightness of the bound.},
  selected={true},
  pdf={https://arxiv.org/pdf/2301.07068.pdf},
  html={https://arxiv.org/abs/2301.07068},
  year={2023}
}

@article{corsi2023constrained,
  title={Constrained Reinforcement Learning and Formal Verification for Safe Colonoscopy Navigation},
  author={Corsi*, Davide and Marzari*, Luca and Pore*, Ameya and Farinelli, Alessandro and Casals, Alicia and Fiorini, Paolo and Dall'Alba, Diego},
  journal={International Conference on Intelligent Robots and Systems (IROS)},
  year={2023},
  abbr={IROS},
  abstract={The field of robotic Flexible Endoscopes (FEs) has progressed significantly, offering a promising solution to reduce patient discomfort. However, the limited autonomy of most robotic FEs results in non-intuitive and challenging manoeuvres, constraining their application in clinical settings. While previous studies have employed lumen tracking for autonomous navigation, they fail to adapt to the presence of obstructions and sharp turns when the endoscope faces the colon wall. In this work, we propose a Deep Reinforcement Learning (DRL)-based navigation strategy that eliminates the need for lumen tracking. However, the use of DRL methods poses safety risks as they do not account for potential hazards associated with the actions taken. To ensure safety, we exploit a Constrained Reinforcement Learning (CRL) method to restrict the policy in a predefined safety regime. Moreover, we present a model selection strategy that utilises Formal Verification (FV) to choose a policy that is entirely safe before deployment. We validate our approach in a virtual colonoscopy environment and report that out of the 300 trained policies, we could identify three policies that are entirely safe. Our work demonstrates that CRL, combined with model selection through FV, can improve the robustness and safety of robotic behaviour in surgical applications.},
  selected={true},
  pdf={https://arxiv.org/pdf/2303.03207.pdf},
  html={https://arxiv.org/abs/2303.03207} 
}


@inproceedings{amir2022verifying,
  title={Verifying Learning-Based Robotic Navigation Systems},
  author={Amir, Guy and Corsi, Davide and Yerushalmi, Raz and Marzari, Luca and Harel, David and Farinelli, Alessandro and Katz, Guy},
  booktitle={Tools and Algorithms for the Construction and Analysis of Systems (TACAS)},
  year={2023},
  organization={TACAS},
  abbr={TACAS},
  abstract={Deep reinforcement learning (DRL) has become a dominant deep-learning paradigm for tasks where complex policies are learned within reactive systems. Unfortunately, these policies are known to be susceptible to bugs. Despite significant progress in DNN verification, there has been little work demonstrating the use of modern verification tools on real-world, DRL-controlled systems. In this case study, we attempt to begin bridging this gap, and focus on the important task of mapless robotic navigation — a classic robotics problem, in which a robot, usually controlled by a DRL agent, needs to efficiently and safely navigate through an unknown arena towards a target. We demonstrate how modern verification engines can be used for effective model selection, i.e., selecting the best available policy for the robot in question from a pool of candidate policies. Specifically, we use verification to detect and rule out policies that may demonstrate suboptimal behavior, such as collisions and infinite loops. We also apply verification to identify models with overly conservative behavior, thus allowing users to choose superior policies, which might be better at finding shorter paths to a target. To validate our work, we conducted extensive experiments on an actual robot, and confirmed that the suboptimal policies detected by our method were indeed flawed. We also demonstrate the superiority of our verification-driven approach over state-of-the-art, gradient attacks. Our work is the first to establish the usefulness of DNN verification in identifying and filtering out suboptimal DRL policies in real-world robots, and we believe that the methods presented here are applicable to a wide range of systems that incorporate deep-learning-based agents.},
  selected={false},
  pdf={https://arxiv.org/pdf/2205.13536.pdf},
  html={https://link.springer.com/chapter/10.1007/978-3-031-30823-9_31} 

}


@inproceedings{AAMAS2023_violationpenalty, 
    title={Safe Deep Reinforcement Learning by Verifying Task-Level Properties}, 
    author={Marchesini*, Enrico and Marzari*, Luca and Farinelli, Alessandro and Amato, Christopher}, 
    abstract={Cost functions are commonly employed in Safe Deep Reinforcement Learning (DRL). However, the cost is typically encoded as an indicator function due to the difficulty of quantifying the risk of policy decisions in the state space. Such an encoding requires the agent to visit numerous unsafe states to learn a cost-value function to drive the learning process toward safety. Hence, increasing the number of unsafe interactions and decreasing sample efficiency. In this paper, we investigate an alternative approach that uses domain knowledge to quantify the risk in the proximity of such states by defining a violation metric. This metric is computed by verifying task-level properties, shaped as input-output conditions, and it is used as a penalty to bias the policy away from unsafe states without learning an additional value function. We investigate the benefits of using the violation metric in standard Safe DRL benchmarks and robotic mapless navigation tasks. The navigation experiments bridge the gap between Safe DRL and robotics, introducing a framework that allows rapid testing on real robots. Our experiments show that policies trained with the violation penalty achieve higher performance over Safe DRL baselines and significantly reduce the number of visited unsafe states.}, 
    booktitle={Proceedings of the 22nd International Conference on Autonomous Agents and MultiAgent Systems (AAMAS)}, 
    year={2023}, 
    abbr={AAMAS},
    selected={false},
    pdf={https://arxiv.org/pdf/2302.10030.pdf},
    html={https://arxiv.org/abs/2302.10030} 
}

@inproceedings{ICRA2023_crop, 
    title={Online Safety Property Collection and Refinement for Safe Deep Reinforcement Learning in Mapless Navigation}, 
    author={Marzari*, Luca and Marchesini*, Enrico and Farinelli, Alessandro}, 
    abstract={Safety is essential for deploying Deep Reinforcement Learning (DRL) algorithms in real-world scenarios.Recently, verification approaches have been proposed to allow quantifying the number of violations of a DRL policy over input-output relationships, called properties. However, such properties are hard-coded and require task-level knowledge, making their application intractable in challenging safety-critical tasks. To this end, we introduce the Collection and Refinement of Online Properties (CROP) framework to design properties at training time. CROP employs a cost signal to identify unsafe interactions and use them to shape safety properties. Hence, we propose a refinement strategy to combine properties that model similar unsafe interactions.Our evaluation compares the benefits of computing the number of violations using standard hard-coded properties and the ones generated with CROP. We evaluate our approach in several robotic mapless navigation tasks and demonstrate that the violation metric computed with CROP allows higher returns and lower violations over previous Safe DRL approaches.}, 
    booktitle={2023 International Conference on Robotics and Automation (ICRA)}, 
    year={2023}, 
    abbr={ICRA},
    selected={false},
    pdf={https://arxiv.org/pdf/2302.06695.pdf},
    html={https://arxiv.org/abs/2302.06695} 
}




---
2022
---

@inproceedings{marzari2022curriculum,
  title={Curriculum learning for safe mapless navigation},
  author={Marzari, Luca and Corsi, Davide and Marchesini, Enrico and Farinelli, Alessandro},
  booktitle={Proceedings of the 37th ACM/SIGAPP Symposium on Applied Computing},
  pages={766--769},
  year={2022},
  organization={ACM SAC IRMAS},
  abbr={ACM SAC IRMAS},
  selected={false},
  pdf={https://arxiv.org/pdf/2112.12490.pdf},
  html={https://dl.acm.org/doi/abs/10.1145/3477314.3507182} 
}


---
2021
---

@inproceedings{marzari2021towards,
  title={Towards hierarchical task decomposition using deep reinforcement learning for pick and place subtasks},
  author={Marzari, Luca and Pore, Ameya and Dall'Alba, Diego and Aragon-Camarasa, Gerardo and Farinelli, Alessandro and Fiorini, Paolo},
  booktitle={2021 20th International Conference on Advanced Robotics (ICAR)},
  pages={640--645},
  year={2021},
  organization={IEEE},
  abbr={IEEE ICAR},
  selected={false},
  pdf={https://arxiv.org/pdf/2102.04022.pdf},
  html={https://ieeexplore.ieee.org/abstract/document/9659344/} 
}
